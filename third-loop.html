<!DOCTYPE html>

<html>

<head>
<title>updating a bar chart with d3.js (v4)</title>
<script src="https://d3js.org/d3.v4.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
</head>

<style>
.radio{
	text-align: center;
}
.row{
	text-align: center;
}
</style>

<body>

<div class='container'>
	<div class='row'>
	<h2> Test Title</h2>
				<p>Test</p>
				<!-- 	<div class='radio'>
						<label class='radio-inline'>
							<input type="radio" name="gender" value="0" onclick='change(this.value)'> male
						</label>
						<label class='radio-inline'>
							<input type="radio" name="gender" value="1" onclick='change(this.value)'> female
						</label>
						<label class='radio-inline'>
							<input type="radio" name="gender" value="both" onclick='change(this.value)' checked > both
						</label>
					</div> -->
			<svg class='chart'>
			</svg>
	</div>
</div>
</body>
<script>



d3.csv("deaths_age_sex.csv" ,
function(d) {

						console.log(d);	
var male = [];
var female = [];
var bothData = [];
for(var i = 0; i < bothData.length; i++){
	if(bothData[i]["viewer_gender"] === "0"){
		maleData.push(bothData[i]);
										}else{
		femaleData.push(bothData[i]);
												}
											 }



//functions for toggling between data
function change(value){

	if(value === 'male'){
		update(male);
						}
	else if(value === '1'){
		update(female);
							}
	else{
		update(bothData);
		}
						}


function update(data){
	//set domain for the x axis
	xChart.domain(data.map(function(d){ return d.age; 
			  }) );
	//set domain for y axis
	yChart.domain( [0, d3.max(data, function(d){ return +d.gender; }
				  )] 
	             );
	var barWidth = width / data.length;

//select all bars on the graph, take them out, and exit the previous data set. 
	//then you can add/enter the new data set
	var bars = chart.selectAll(".bar")
					.remove()
					.exit()
					.data(d)		

bars.enter()
		.append("rect")
		.attr("class", "bar")
		.attr("x", function(d, i){ return i * barWidth + 1 })
		.attr("y", function(d){ return yChart( d.watch_time_minutes); })
		.attr("height", function(d){ return height - yChart(d.watch_time_minutes); }) //add age
		.attr("width", barWidth - 1)
		.attr("fill", function(d){ 
			if(d.gender === "1"){
				return "rgb(251,180,174)";
			}else{
				return "rgb(179,205,227)";


			          }

			    });
      
	//left axis
	chart.select('.y')
		  .call(yAxis)
	//bottom axis
	chart.select('.xAxis')
		.attr("transform", "translate(0," + height + ")")
		.call(xAxis)
		.selectAll("text")
			.style("text-anchor", "end")
			.attr("dx", "-.8em")
			.attr("dy", ".15em")
			.attr("transform", function(d){
				return "rotate(-65)";














			});





			})
		
		




</script>